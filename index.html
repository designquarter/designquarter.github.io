<html>
<head>
<title>Design Quarter</title>
<script language="javascript">

    var getJSON = function(url, callback) {
        var xhr = new XMLHttpRequest();
        xhr.open('GET', url, true);
        xhr.responseType = 'json';
        xhr.onload = function() {
          var status = xhr.status;
          if (status === 200) {
            callback(null, xhr.response);
          } else {
            callback(status, xhr.response);
          }
        };
        xhr.send();
    };
    
    
    var filePath = 'https://spreadsheets.google.com/feeds/list/1WD9udj2e5QmPR1vPuYWf0EQqjkfXmeIEPgR3ssa-vmw/od6/public/values?alt=json'
    getJSON(filePath,
    function(err, data) {
      if (err !== null) {
        console.log('Something went wrong: ' + err);
      } else {
    
    for (i = 0; i < data.feed.entry.length; i++) {
        console.log(data.feed.entry[i].gsx$email.$t);
    }
    
      }
    });
    
    
    </script>
</head>

<body>

<p>Hello World 3</p>

<form name="submit-to-google-sheet">
    <input name="email" type="email" placeholder="Email" required>
    <button type="submit">Send</button>
</form>
  
<script>
    const scriptURL = 'https://script.google.com/macros/s/AKfycbzbA13sGRe1_5q7PamogqnkQZ9P-0xaNVa4CjTPacABJFjbbvM/exec'
    const form = document.forms['submit-to-google-sheet']
  
    form.addEventListener('submit', e => {
      e.preventDefault()
      fetch(scriptURL, { method: 'POST', body: new FormData(form)})
        .then(response => console.log('Success!', response))
        .catch(error => console.error('Error!', error.message))
    })
</script>

</body>
</html>